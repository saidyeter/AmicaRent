@model AmicaRent.OfficialWeb.Models.AracFiltreViewModel

@{
    var startDays = new List<string>();
    var endDays = new List<string>();
    for (DateTime i = DateTime.Now; i < DateTime.Now.AddMonths(2); i = i.AddDays(1))
    {
        startDays.Add(i.ToString("dd.MM.yyyy"));
        endDays.Add(i.ToString("dd.MM.yyyy"));
    }

    var startTimes = new List<string>();
    var endTimes = new List<string>();
    var n = DateTime.Now;
    var morning = new DateTime(n.Year, n.Month, n.Day, 7, 0, 0);
    var evening = new DateTime(n.Year, n.Month, n.Day, 22, 0, 1);
    for (DateTime i = morning; i < evening; i = i.AddHours(1))
    {
        startTimes.Add(i.ToString("hh:mm"));
        endTimes.Add(i.ToString("hh:mm"));
    }


    List<AmicaRent.DataAccess.Lokasyon> locationsFromViewBag = ViewBag.Lokasyonlar;
    Dictionary<int, string> locationList = new Dictionary<int, string>();

    foreach (var lokasyon in locationsFromViewBag)
    {
        locationList.Add(lokasyon.Lokasyon_ID, lokasyon.Lokasyon_Adi);
    }
}
<section class="carlist">
    @Html.Partial("_Header")
    <div class="container">
        <h1>
            Araç Listesi
        </h1>
        <nav aria-label="breadcrumb">
            <ol class="breadcrumb">
                <li class="breadcrumb-item"><a href="#">Home</a></li>
                <li class="breadcrumb-item active" aria-current="page">Library</li>
            </ol>
        </nav>
    </div>

</section>
<section class="vehicle_list mt-0 pt-0" style="background: none;">

    <div class="container">
        <div class="row">
            <div class="col-8">
                <div class="vehicleslist">
                    <div class="row">
                        @foreach (var item in Model.aracList)
                        {
                            <div class="col-6">
                                <div class="car_area">

                                    <div class="img_area">
                                        <img src="@item.Base64Resim" />
                                    </div>
                                    <div class="title_area">
                                        <div class="title">
                                            @item.MarkaModel
                                        </div>
                                        <div class="subtitle">
                                        </div>
                                    </div>
                                    <div class="feature_area">
                                        <div class="row">
                                            <div class="col-6 pr-0">
                                                <span class="col-6 float-left border_bottom">Yıl</span><span class="col-6 float-right border_bottom text-right border_right">@item.Yil</span>
                                            </div>
                                            <div class="col-6 pl-0">
                                                <span class="col-6 float-left border_bottom">Depo</span><span class="col-6 float-right border_bottom text-right">@item.YakitTuru</span>
                                            </div>
                                            <div class="col-6 pr-0">
                                                <span class="col-6 float-left">Vites</span><span class="col-6 float-right border_right">@item.VitesTuru</span>
                                            </div>
                                            <div class="col-6 pl-0">
                                                <span class="col-6 float-left">Kilometre</span><span class="col-6 float-right text-right">@String.Format("{0:n0}", item.KM)</span>
                                            </div>
                                        </div>
                                    </div>

                                </div>

                                <div class="reservation_area">
                                    <a onclick="reservation(@item.Arac_ID)">rezervasyon yap</a>
                                </div>
                            </div>

                        }
                    </div>
                </div>
            </div>

            <div class="col-4">
                <div class="saerch_car_area">
                    <h2>
                        kiralık araç bul!
                    </h2>
                    <div class="carlistsearcharea">
                        <form method="POST" action="/araclistesi">

                            <div class="col-12">
                                <div class="form-group">
                                    <label for="" class="form-label">Alış Lokasyonu</label>
                                    @Html.DropDownListFor(model => model.alisLokasyon, new SelectList(locationList, "Key", "Value"), new { @class = "form_select" })
                                </div>
                            </div>
                            <div class="col-12">
                                <div class="form-group">
                                    <label for="" class="form-label">Dönüş Lokasyonu</label>
                                    @Html.DropDownListFor(model => model.donusLokasyon, new SelectList(locationList, "Key", "Value"), new { @class = "form_select" })
                                </div>
                            </div>
                            <div class="col-12">
                                <div class="form-group">
                                    <label for="" class="form-label">Alış Tarihi</label>
                                    @Html.DropDownListFor(model => model.alisGun, new SelectList(startDays), new { @class = "form_select" })

                                </div>
                            </div>
                            <div class="col-12">
                                <div class="form-group">
                                    <label for="" class="form-label">Alış Saati</label>
                                    @Html.DropDownListFor(model => model.alisSaat, new SelectList(startTimes), new { @class = "form_select" })

                                </div>
                            </div>
                            <div class="col-12">
                                <div class="form-group">
                                    <label for="" class="form-label">Dönüş Tarihi</label>
                                    @Html.DropDownListFor(model => model.donusGun, new SelectList(endDays), new { @class = "form_select" })

                                </div>
                            </div>
                            <div class="col-12">
                                <div class="form-group">
                                    <label for="" class="form-label">Dönüş Saati</label>
                                    @Html.DropDownListFor(model => model.donusSaat, new SelectList(endTimes), new { @class = "form_select" })

                                </div>
                            </div>
                            <div class="col-12">
                                <button type="submit">
                                    Filtrele
                                </button>
                            </div>

                        </form>
                    </div>

                </div>
            </div>

        </div>
    </div>
</section>


<script type="text/javascript">
    function reservation(aracId) {
        var alisLokasyon = document.getElementById('alisLokasyon').value
        var donusLokasyon = document.getElementById('donusLokasyon').value
        var alisGun = document.getElementById('alisGun').value
        var alisSaat = document.getElementById('alisSaat').value
        var donusGun = document.getElementById('donusGun').value
        var donusSaat = document.getElementById('donusSaat').value

        var opt = `a=${aracId}&al=${alisLokasyon}&dl=${donusLokasyon}&ag=${alisGun}&as=${alisSaat}&dg=${donusGun}&ds=${donusSaat}`;
        var href = `/RezervasyonYap?o=${btoa(opt)}`
        location.href = href
    }
</script>